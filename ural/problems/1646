<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=utf-8"><META NAME="viewport" CONTENT="width=768"><META HTTP-EQUIV="X-UA-Compatible" CONTENT="IE=edge"><TITLE>1646. Godzilla Strikes Back! @ Timus Online Judge</TITLE><LINK REL="alternate" HREFLANG="x-default" HREF="/problem.aspx?num=1646"><LINK REL="alternate" HREFLANG="en-us" HREF="/problem.aspx?num=1646&amp;locale=en"><LINK REL="alternate" HREFLANG="ru-ru" HREF="/problem.aspx?num=1646&amp;locale=ru"><LINK REL="stylesheet" TYPE="text/css" HREF="/style47.css"><LINK REL="shortcut icon" TYPE="image/x-icon" HREF="/favicon.ico"></HEAD><BODY ALINK="#1A5CC8" VLINK="#1A5CC8" LINK="#1A5CC8"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="body"><TR><TD CLASS="caption"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" CLASS="locale"><A HREF="/problem.aspx?num=1646&amp;locale=en">ENG</A>&nbsp;&nbsp;<A HREF="/problem.aspx?num=1646&amp;locale=ru">RUS</A></TD><TD CLASS="title"><A HREF="/">Timus Online Judge</A></TD><TD WIDTH="130"></TD></TR></TABLE></TD></TR><TR><TD CLASS="panel"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" VALIGN="TOP" ALIGN="CENTER" STYLE="padding-bottom:5px;"><A HREF="/"><IMG BORDER="0" SRC="/images/usu-summer.jpg" HEIGHT="134" WIDTH="106" ALT=""></A></TD><TD VALIGN="TOP" ALIGN="LEFT"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="panel"><TR><TH WIDTH="25%"><DIV>Online Judge</DIV></TH><TH WIDTH="25%"><DIV>Problems</DIV></TH><TH WIDTH="25%"><DIV>Authors</DIV></TH><TH WIDTH="25%"><DIV>Online contests</DIV></TH></TR><TR><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/">About Online Judge</A><BR><A HREF="/help.aspx?topic=faq">Frequently asked questions</A><BR><A HREF="/news.aspx">Site news</A><BR><A HREF="/forum/">Webboard</A><BR><A HREF="/help.aspx?topic=links">Links</A><BR></TD><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/problemset.aspx">Problem set</A><BR><A HREF="/submit.aspx">Submit solution</A><BR><A HREF="/status.aspx">Judge status</A><BR><A HREF="/help.aspx?topic=judge">Guide</A><BR></TD><TD VALIGN="TOP"><A HREF="/register.aspx">Register</A><BR><A HREF="/authedit.aspx">Update your info</A><BR><A HREF="/ranklist.aspx">Authors ranklist</A><BR><FORM ACTION="/search.aspx" METHOD="GET" STYLE="margin:0.6em 0em 0em 0em;"><INPUT NAME="Str" SIZE="12" VALUE="" PLACEHOLDER="Author’s name"> <INPUT TYPE="SUBMIT" VALUE="Search"></FORM></TD><TD VALIGN="TOP"><A HREF="/contest.aspx">Current contest</A><BR><A HREF="/schedule.aspx">Scheduled contests</A><BR><A HREF="/archive.aspx">Past contests</A><BR><A HREF="/help.aspx?topic=contest">Rules</A><BR></TD></TR></TABLE></TD></TR></TABLE></TD></TR><TR><TD STYLE="padding-top: 32px; padding-bottom: 20px;"><TABLE ALIGN="CENTER" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="800"><DIV CLASS="problem_content"><H2 class="problem_title">1646. Godzilla Strikes Back!</H2><DIV class="problem_limits">Time limit: 1.0 second<BR>Memory limit: 64 MB<BR></DIV><DIV ID="problem_text"><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">As you all know, a DNA is a string over an alphabet <code>{'A', 'C', 'G', 'T'}</code>.

In 2567, scientists from the Cytology and Genetics Research Institute decided to create an extremely powerful giant pangolin
called Bugzilla. It is known that the height and the power of the pangolin is completely determined by its DNA.
The process of creating Bugzilla's DNA took <i>m</i> days.
The scientists had a bank of numbered DNAs, which initially contained 2 DNAs of some mutant pangolins. These DNAs
were numbered 1 and 2.

On day <i>k</i>, the scientists chose DNAs number <i>i</i> and <i>j</i> from the bank (<i>i</i> can be equal to <i>j</i>),
concatenated them to form a new DNA and added it to the bank, assigning number <i>k</i> + 2 to it.

Finally, after <i>m</i> days the desired DNA of a giant pangolin was formed (it had a number <i>m</i> + 2 in the bank). Somehow the newspapers found out about these experiments, and the citizens began to panic. What to expect from a new, more powerful monster, if its prototype, Godzilla, was bad enough to destroy the city completely?
To answer this question you should count the number of occurences of Godzilla's DNA in Bugzilla's one.</DIV></DIV><H3 CLASS="problem_subtitle">Input</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The first line contains Godzilla's DNA from a museum of the Cytology and Genetics Research Institute. Its length doesn't
exceed 100.
The next two lines contain two DNAs of the mutant pangolins, which were initially in the bank. The length of each of these DNAs
is at most 10.
The forth line contains an integer <i>m</i> <nobr>(1 &le; <i>m</i> &le; 100)</nobr> &mdash; the day Bugzilla's
DNA was created on.
Then follow <i>m</i> lines. <i>k</i>-th line contains a pair of space-separated integers (from 1 to <i>k</i>&nbsp;+&nbsp;1)
&mdash; the numbers of DNAs from the bank which were concatenated by scientists on <i>k</i>-th day.
</DIV></DIV><H3 CLASS="problem_subtitle">Output</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Output the number of occurences of Godzilla's DNA in Bugzilla's one modulo 10<sup>9</sup>&nbsp;+&nbsp;7.
</DIV></DIV><H3 CLASS="problem_subtitle">Samples</H3><TABLE CLASS="sample"><TR><TH WIDTH="350">input</TH><TH WIDTH="350">output</TH></TR><TR><TD><PRE CLASS="intable">AGA
A
G
4
1 2
2 1
3 1
5 4
</PRE></TD><TD><PRE CLASS="intable">2
</PRE></TD></TR><TR><TD><PRE CLASS="intable">A
CT
AG
2
1 1
3 3
</PRE></TD><TD><PRE CLASS="intable">0</PRE></TD></TR></TABLE><H3 CLASS="problem_subtitle">Notes</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">In the first sample, the scientists consecutively obtained the following DNAs: <i>AG</i>, <i>GA</i>,
<i>AGA</i>, <i>AGAGA</i>. <i>AGA</i> occurs twice in <i>AGAGA</i>.
</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">In the second sample, the following DNAs were obtained: <i>CTCT</i>, <i>CTCTCTCT</i>. <i>A</i>
doesn't occur in <i>CTCTCTCT</i>.
</DIV></DIV><DIV CLASS="problem_source"><B>Problem Author: </B>Ivan Burmistrov<BR><B>Problem Source: </B>USU Junior Contest, October 2008<BR></DIV></DIV></DIV><DIV><B>Tags: </B>none  <SPAN CLASS="problem_tags_toggle">(<FORM METHOD="POST" ACTION="problem.aspx?space=1&amp;num=1646" STYLE="display:inline; margin:0;" ID="ToggleTagsForm"><A HREF="problem.aspx?space=1&amp;num=1646" ONCLICK="document.getElementById('ToggleTagsForm').submit();return false;"><INPUT TYPE="hidden" NAME="Action" VALUE="HideTags">hide tags for unsolved problems</A></FORM>)</SPAN></DIV><DIV CLASS="problem_links"><SPAN>Difficulty: 769</SPAN>    <A HREF="print.aspx?space=1&amp;num=1646" TARGET="_blank">Printable version</A>    <A HREF="submit.aspx?space=1&amp;num=1646">Submit solution</A>    <A HREF="forum/?space=1&amp;num=1646">Discussion (5)</A><BR><A HREF="status.aspx?space=1&amp;num=1646">All submissions (2106)</A>    <A HREF="status.aspx?space=1&amp;num=1646&amp;status=accepted">All accepted submissions (436)</A>    <A HREF="rating.aspx?space=1&amp;num=1646">Solutions rating (356)</A></DIV></TD></TR></TABLE></TD></TR><TR><TD CLASS="footer"><script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({id:20918869, webvisor:true, clickmap:true, trackLinks:true, accurateTrackBounce:true}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="//mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""></div></noscript>© 2000–2016 <A HREF="/team.aspx">Timus Online Judge Team</A>. All rights reserved.</TD></TR></TABLE></BODY></HTML>
